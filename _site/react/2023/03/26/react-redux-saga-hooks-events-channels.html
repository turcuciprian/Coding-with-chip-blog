<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8" />

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Event Channels in React Redux Saga Hooks | Coding With Chip - Blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Event Channels in React Redux Saga Hooks" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the tutorial available here: https://youtu.be/cTcThsNqqcg I explain how eventChannels work using sockets ( a socket server ) and a react with redux hooks saga implementation." />
<meta property="og:description" content="In the tutorial available here: https://youtu.be/cTcThsNqqcg I explain how eventChannels work using sockets ( a socket server ) and a react with redux hooks saga implementation." />
<link rel="canonical" href="http://localhost:4000/react/2023/03/26/react-redux-saga-hooks-events-channels.html" />
<meta property="og:url" content="http://localhost:4000/react/2023/03/26/react-redux-saga-hooks-events-channels.html" />
<meta property="og:site_name" content="Coding With Chip - Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-26T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Event Channels in React Redux Saga Hooks" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-26T00:00:00+02:00","datePublished":"2023-03-26T00:00:00+02:00","description":"In the tutorial available here: https://youtu.be/cTcThsNqqcg I explain how eventChannels work using sockets ( a socket server ) and a react with redux hooks saga implementation.","headline":"Event Channels in React Redux Saga Hooks","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/react/2023/03/26/react-redux-saga-hooks-events-channels.html"},"url":"http://localhost:4000/react/2023/03/26/react-redux-saga-hooks-events-channels.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap"
      as="style"
      type="text/css"
      crossorigin
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#157878" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <link
      rel="stylesheet"
      href="/assets/css/style.css?v="
    />
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <h1 class="project-name">
        <a style="color: white" id="home-page" href="/">Coding With Chip - Blog</a>
      </h1>
      <h2 class="project-tagline">The scripts from the youtube channel and more, in text format, with updated code and documentation</h2>
       
    </header>

    <main id="content" class="main-content" role="main">
      

<section class="collection-head small geopattern" data-pattern-id="Event Channels ">
<div class="container">
  <div class="columns">
    <div class="column three-fourths">
      <div class="collection-title">
        <h1 class="collection-header">Event Channels in React Redux Saga Hooks</h1>
        <div class="collection-info">
          
          <span class="meta-info">
            <span class="octicon octicon-calendar"></span> 2023/03/26
          </span>
          
          
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href="http://localhost:4000/categories/react" title="react">react</a>
          </span>
          
          
        </div>
      </div>
    </div>
    <div class="column one-fourth mobile-hidden">
      <div class="collection-title">
      </div>
    </div>
  </div>
</div>
</section>
<!-- / .banner -->
<section class="container content">
<div class="columns">
  <div class="column three-fourths" >
    <article class="article-content markdown-body">
    <p>In the tutorial available here: <a href="https://youtu.be/cTcThsNqqcg">https://youtu.be/cTcThsNqqcg</a>
I explain how eventChannels work using sockets ( a socket server ) and a react with redux hooks saga implementation.</p>

<h2 id="the-code">The code</h2>

<h3 id="server">Server</h3>

<p>the server app is just starting a socket server and emiting some strings every 3 seconds with the current value of the seconds of the server clock.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const express = require('express');
const app = express();
var cors = require('cors');
app.options('*', cors())
const http = require('http');
const httpServer = http.createServer(app);
const io = require("socket.io")(httpServer, {
  cors: {
    origin: "http://192.168.1.135:3000",
    methods: ["GET", "POST"],
    allowedHeaders: ["Access-Control-Allow-Origin"]
  },
  origins: ["http://192.168.1.135:3000"]
});


app.get('/', (req, res) =&gt; {
  res.sendFile(__dirname + '/index.html');
});
var intervalID;

io.on('connection', (socket) =&gt; {
  console.log('a user connected');
  clearInterval(intervalID);
  intervalID = setInterval(function () {
    console.log(new Date().getSeconds());
    socket.emit('seconds', new Date().getSeconds());
  }, 3000);
});

httpServer.listen(3001, () =&gt; {
  console.log('listening on *:3001');
});

</code></pre></div></div>

<h3 id="saga-code">Saga Code</h3>

<p>This is just the saga file containing the generator, but it’s the full file showing the eventChannel and socket implementation</p>

<p>For a full react Implementation with redux saga in hooks, as a previous project showing react redux saga with hooke, you can find</p>

<p>Meanwhile, here’s the code of the final saga file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import { put, take, takeLatest, all, call } from "redux-saga/effects";
import { eventChannel, END } from 'redux-saga'
import { io } from "socket.io-client";
const receiveMessage = (socket) =&gt; {
  socket.on("disconnect", () =&gt; {
    socket.connect();
    console.log('socket disconnected');
  });
  return eventChannel((emitter) =&gt; {
    socket.on('seconds', (msg) =&gt; {
      emitter(msg);
    });
    return () =&gt; {
      emitter(END);
    }
  });
};

const runOurAction = function* () {
  const socket = io('http://192.168.1.135:3001');
  const chan = yield call(receiveMessage, socket);
  while (true) {
    try {
      const value = yield take(chan);
      yield put({ type: "SET_DATA", payload: value });
    } catch (err) {
      console.error('socket error:', err)
      // socketChannel is still open in catch block
      // if we want end the socketChannel, we need close it explicitly
      // socketChannel.close()
    }
  }
};
function* getAsyncDataWatcher() {
  yield takeLatest("GET_ASYNC_DATA", runOurAction);
}

export default function* rootSaga() {
  yield all([getAsyncDataWatcher()]);
}
</code></pre></div></div>

<h4 id="thats-all-folks">That’s all Folks!</h4>

    </article>
    <div class="share">
    </div>
    <div class="comment">
    </div>
  </div>
  <div class="column one-fourth">
  </div>
</div>
</section>
<!-- /section.content -->

      <footer class="site-footer">
        
        <span class="site-footer-credits"
          >This page was generated by
          <a href="https://pages.github.com">GitHub Pages</a>.</span
        >
      </footer>
    </main>
  </body>
</html>
